\chapter{Idler-frame case study}\label{chap:chapter3}

In this chapter, I apply the methods and learnings from Chap.~\ref{chap:chapter2} to an industry dataset of the failure times of idler frames on an overland iron ore conveyor. The idler frames were described briefly in Sec.~\ref{sec:industry-data}. For a reliability engineer tasked with maintaining the conveyor, it can be useful to quantify the expected failure times of the idler frames currently in operation and the expected number of failures in the next short time interval, such as \citet{hong2009} do for power transformers. I show how these quantities are already naturally contained in the full posterior of the Bayesian model when the censored lifetimes are imputed as in Sec.~\ref{subsec:censoring-treatments}. It is also useful to propagate uncertainty in the posterior estimates of the parameters through any decision criteria to understand risk in long-term maintenance plans, such as the design of a fixed-time replacement strategy. I demonstrate how the joint posterior draws of the Weibull parameters can be propagated through a cost function to make an informed decision about a fixed-time replacement strategy for the idlers in the frames.

The chapter is structured as follows. Section~\ref{sec:idler-frame-data-desc} describes the data in detail. In Sec.~\ref{sec:idler-frame-joint-prior}, I construct an informative prior for the idler frame analysis based on prior knowledge supplied by the idler manufacturer and a conveyor engineer. Section~\ref{sec:idler-frame-posterior} describes the model fitting process and posterior inference on the parameters. Section~\ref{sec:idler-frames-using-posterior} goes on to demonstrate how the draws from the posterior can be used. Specifically, Sec.~\ref{subsec:idler-FTs} and~\ref{subsec:idler-cumulative-failrues} show how to obtain the estimated remaining useful life of the currently installed idler frames and the expected number of failures in a time interval following the end of observation, respectively. Sec~\ref{subsec:idler-cost-function} then shows how to propagate the posterior uncertainty about the lifetime distribution through a utility functions, specifically a cost function, to inform the choice of a preventative replacement interval for the idler frames. Finally, Sec.~\ref{sec:idler-frame-conclusions} summarises the main results of the chapter.

\section{Idler frame lifetime data} \label{sec:idler-frame-data-desc}

The data is a synthesis of preventative and reactive replacement records of idlers on a single overland iron ore conveyor. It is one of many such datasets for similar conveyors on the mine. This particular conveyor has 143 frames of idlers, each with a three-idler configuration. When an idler in the frame fails, all three of the idlers are usually replaced, so each idler frame can be viewed as one unit. The replacements of the idlers in a frame are often captured in the CMMS, and if an idler in the frame has been observed as having failed and is scheduled to be replaced, this information is included in the replacement record. However, if an idler in the frame has failed in a way that threatens to damage the belt immediately, this information is raised in a different system, the belt is shut down, and the idlers in that frame are replaced. During an industry placement, I cleaned and collated these different sources of replacement records into a single dataset. The dataset spans just over six years, but the conveyor has been in operation for twenty.

From the replacement records, the lifetimes of the idler frames can be calculated as the time between the replacements. However, since the records do not go back to the commissioning of the conveyor, the first observed lifetime for each frame is left-truncated and has unknown installation time. Because the sets of idlers in some frames are preventatively replaced or because some were still in operation when I constructed the dataset, there are many right-censored lifetimes. Table~\ref{tab:idler-frame-summary} gives an overview of the dataset, and Fig.~\ref{fig:idler-frames-data} shows the lifetimes of each frame along the conveyor. In Fig.~\ref{fig:idler-frames-data}, the fully observed lifetimes, where we have observed the failure of an idler in the frame as well as the previous failure for that frame, are shown as orange points, while the partially observed lifetimes are shown in blue. The partially observed lifetimes that are left-truncated by the beginning of the observation period are shown as triangular points, while the remainder of the blue points are right-censored observations.

\input{./tables/ch-3/data_summary.tex}

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/idler-frame-data.pdf}
  \caption{The idler frame lifetimes plotted along the length of the conveyor. On the horizontal axis is the frame number that the lifetimes belong to, and on the vertical axis is the lifetime in days on the log scale. The fully observed lifetimes are orange points, while the partially observed (censored) lifetimes are blue. The censored lifetimes that are left-truncated by the start of the observation period are shown as triangular points.}
  \label{fig:idler-frames-data}
\end{figure}

Table~\ref{tab:idler-frame-summary} shows that roughly thirty-six per cent of the lifetimes in the dataset are left-truncated with unknown installation times. Therefore, if we were to discard these observations, we would throw away a third of the data. As Sec.~\ref{sec:weibull-sim-example} shows, it is better to retain the information in these left-truncated lifetimes.

Based on our understanding of how the idler frames fail and from the characteristics of the dataset described in Table~\ref{tab:idler-frame-summary}, the methods that I developed in Chap.~\ref{chap:chapter2} can be used to impute the partially observed truncated lifetimes. The Weibull distribution appears appropriate to model the idler frame lifetimes since the idlers in the frames fail via a wear-out failure mechanism. Furthermore, the frame's failure time is when the first idler in the frame fails, which is consistent with the extreme value distribution interpretation of the Weibull (discussed in Sec.~\ref{subsec:weibull-dist}). The observation period spans just over six years, and it starts roughly 14 years after the conveyor was commissioned. According to the idler manufacturer, the expected lifetime of an idler is roughly five years, and since the lifetime of a frame is the first of the three idlers to fail, the expected lifetime of a frame should be a little under this value. Hence, the observation window is greater than the expected lifetime, and the time from the commissioning of the conveyor ($t = 0$) to the start of the observation period ($t_{start}$) is roughly three times greater. Furthermore, only one lifetime is left-truncated/interval-censored by the beginning of observation and right-censored by its end. Under these circumstances, the methods proposed in Chap.~\ref{chap:chapter2} to account for the lifetimes that are left-truncated with unknown exposure history can be used.

In the idler dataset, there are some very short lifetimes---twenty-five that are less than three weeks---that most likely arise from manufacturing defects or incorrect installation. In this analysis, I aim to model the wear-out failure mechanism of the idler frames, and therefore, I treat any lifetimes shorter than three weeks as right-censoring events; this is also done by \citet{hong2009} in their analysis of power transformers: the failure due to wear was right-censored by the early failure due to another cause.

\section{An informative prior} \label{sec:idler-frame-joint-prior}

Based on engineering knowledge and information provided by the manufacturer, I construct an informative joint prior for the idler frames to supplement the analysis. According to the manufacturer, the expected lifetime of an idler is five years, and according to conveyor engineers, it is unlikely that they will last longer than eight. I express this information as estimates of the CDF at $t_1 = 5 \times 365 = 1825$ and $t_2 = 8 \times 365 = 2920$ days, encoded as the two normal distributions, as in Sec.~\ref{sec:weibull-joint-prior}. The prior distributions for the CDF at $t_1$ and $t_2$ are
\begin{align*}
  \hat{F}_{t_1} \sim & \hbox{N}^{1}_{0}\left(0.50, 0.15\right)    \\
  \hat{F}_{t_2} \sim & \hbox{N}^{1}_{\hat{F}_{t_1}}\left(0.98, 0.05\right).
\end{align*}
I assign relatively large standard deviations since the expected lifetime of a frame of idlers is actually the expected smallest value of the three idlers in the frame. The resulting informative joint prior is shown in Fig.~\ref{fig:idler-frames-prior}. Plot~(a) shows 3000 joint draws of the shape $\beta$ and scale $\eta$ from the informative prior, and plot~(b) shows the resulting prior uncertainty in the CDF. The joint prior distribution in Fig.~\ref{fig:idler-frames-prior}~(a) has a long tail to $\beta = 0$ and $\eta = 0$, which is an unrealistic region of the parameter space. However, the lifetime data will be capable of informing this area of parameter space since it corresponds to early failures, which are not masked by censoring. Hence, this unrealistic area of the prior does not impact on the posterior.

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/idler-frame-prior.pdf}
  \caption{The joint informative prior from eliciting information at $t_1 = 1825$ and $t_2 = 2920$. (a) shows 3000 draws from the informative joint prior, and (b) shows the resulting uncertainty surrounding the CDF.}
  \label{fig:idler-frames-prior}
\end{figure}

\section{Posterior draws} \label{sec:idler-frame-posterior}

To perform inference, I draw $6000$ samples from the posterior using $4$ chains, each $2000$ iterations long and with a burn-in of $500$ iterations and no thinning\footnote{No thinning was used, based on the recommendations \citet[Sec.~16.4]{Stan2024}. Autocorelation is less of a problem with HMC samplers and thinning draws can cause negative autocorelation. So, the only justification for thinning draws from stan is to reduce memory requirements, which is not the case here.}. The Stan output summarising the joint posterior draws of $\beta$ and $\eta$ is shown in Table~\ref{tab:idler-frame-posterior-summary} and the joint draws are plotted in Fig.~\ref{fig:idler-frames-post}~(a). Sampling is efficient with no divergences, the chains mix well, indicated by $\hat{R}$ values of $\approx 1$, and both parameters have a large number of effective samples. The posterior mean of the shape is just above one ($1.10$), but there is a small amount of mass just below one, and the posterior mean of the scale is $1363$. These values of the parameters yield an average frame lifetime of $1315$ days or $3.6$ years with $90\%$ lower and upper bounds of $3.2$ years and $3.9$ years, which is smaller than $5$ years, the average lifetime  specified by the manufacturer.

\input{./tables/ch-3/stan-summary.tex}

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/idler-frame-post.pdf}
  \caption{The joint draws of the Weibull parameters $\beta$ and $\eta$ from the posterior distribution. (a) shows the plain draws, and (b) compares the draws with the contours of the informative joint prior.}
  \label{fig:idler-frames-post}
\end{figure}

Figure~\ref{fig:idler-frames-post}~(b) compares the draws from the posterior with the informative joint prior. The posterior draws sit at the lower left-hand corner of the joint prior but are still contained in the prior. The likelihood is informative enough that inference about the shape and scale are invariant to changes in the prior. Although I do not show such sensitivity checks here, the code provided on the GitHub repository can be easily modified to explore different values of the hyperparameters. Figure~\ref{fig:idler-frames-post-cdf} shows the updated belief of the CDF that results from the posterior. The uncertainty surrounding the CDF of the lifetime distribution in the figures is much narrower than the prior (Fig.~\ref{fig:idler-frames-prior}~(b)). The posterior mean of the CDF at $t_1$ and $t_2$ are $0.75$ and $0.90$, respectively. These updated estimates sit in the tails of the distributions I specified to construct the prior in Sec.~\ref{sec:idler-frame-joint-prior}. The discrepancy between the prior and the posterior indicates a slight prior-likelihood conflict; however, the likelihood is informative enough, in this case, to not be influenced by the prior, and the prior has mass around the fitted model.

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/idler-frame-post-CDF.pdf}
  \caption{The resulting posterior uncertainty surrounding the Weibull CDF of the idler frame lifetime distribution.}
  \label{fig:idler-frames-post-cdf}
\end{figure}

\section{Using posterior samples in decisions} \label{sec:idler-frames-using-posterior}

While the posterior estimates of the parameters are useful in understanding the lifetime distribution, the real value in a Bayesian analysis comes from the uncertainty quantification expressed in the full posterior. Using the draws from the full posterior, which includes the draws of the latent parameters in the model, such as the imputed censored values, we can quantify risk and inform decisions. For example, by imputing the underlying values of the partially observed lifetimes during the MCMC sampling routine, we obtain a distribution for their predicted failure times and consequently can also derive the expected number of failures in the next short time interval. We can also pass the joint draws of the parameters through `utility' functions \citep[Chap.~9]{BDA2020}, for example, a cost function, to incorporate the uncertainty in the analysis into long-term decision-making. Below, Sec.~\ref{subsec:idler-FTs} shows how to obtain predictive distributions of remaining useful life (RUL) for each idler frame still in operation at the end of the observation period. I then show in Sec.~\ref{subsec:idler-cumulative-failrues}, how these RUL distributions can be used to construct a predictive distribution for the cumulative number of failures after the end of the observation period. Finally, Sec.~\ref{subsec:idler-cost-function}, demonstrates how the joint draws of the parameters can be used in a cost function to propagate the uncertainty from the analysis and inform the choice of a fixed-time replacement strategy.

\subsection{Failure time of units in operation} \label{subsec:idler-FTs}

In the model for the idler frame lifetimes, the unobserved values of the censored lifetimes are treated as missing data and their values are imputed, which in a Bayesian framework is to treat them like a parameter in the model. Since I impute the values during the HMC routine, I obtain draws of the imputed values of the censored lifetimes. These draws form predictive distributions for the missing lifetimes of the right-censored units conditioned on their age. These densities could also be calculated if we were to integrate out the censored lifetimes, as discussed in Sec.~\ref{subsec:censoring-treatments}, and also if we used maximum likelihood to estimate parameters, as \citet{hong2009} do. But in these cases, we would need to calculate the distribution conditional on each censored component's age separately, and if we were to use maximum likelihood, we would need to calculate uncertainty intervals using an appropriate method. It is much more convenient to impute the values in the Bayesian analysis since the estimates and uncertainty for each censored observation are already contained in the posterior.

Using the posterior draws of the imputed lifetimes, I calculate draws of the predicted remaining useful life of each unit still under test by subtracting the censoring time $c^{\textit{\tiny{Lower}}}_i$ from the imputed value of the lifetime $\tilde{y}_{i}$ according to
\begin{equation} \label{eq:idler-rul}
  \hbox{RUL}^s_i  = \tilde{y}_{i}^s - c^{\textit{\tiny{Lower}}}_i,
\end{equation}
where $s$ indicates a particular draw from the posterior. The remaining useful life distributions for each of the $143$ frames are shown in Fig.~\ref{fig:idler-FTs}. These distributions can not only be used to obtain point estimates and uncertainty bounds for the RUL, but also to order the frames in terms of the highest risk of failure in a particular number of days or, as I show in the next section, to determine the expected number of failures within the next short time interval.

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/posterior-FTs.pdf}
  \caption{The remaining useful life distributions for the current lifetimes (the lifetimes right-censored by the end of observation). The left plot shows frames $1$ to $72$, and the right shows frames $73$ through $143$.}
  \label{fig:idler-FTs}
\end{figure}

\subsection{Expected number of failures} \label{subsec:idler-cumulative-failrues}

With each draw from the posterior, I obtain a set of imputed values for the lifetimes of the idler frames still in operation and, with these, predictions of the RUL of each idler frame that is right-censored by the observation. Using the draws of RUL, I can calculate the posterior predictive distribution for the cumulative failures from the end of the observation period as follows. Let a posterior draw of the number of failures at $t$ days after the end of the observation period be $K^s = \sum^{n}_{i = 1}I^s_i$, where $I^s_i = 1$ if $\text{RUL}^s_i < t$ and $I^s_i = 0$ if $\text{RUL}^s_i > t$, $n$ is the number of idler frames, and the draws of $\text{RUL}_i$ are calculated as in eq.~\eqref{eq:idler-rul}. For each posterior draw $s$ the value of $K^s$ over the range of $t$, $[0, \inf)$, is a step function $K = g_K(t|\text{RUL}^s)$, where $\text{RUL} = \{\text{RUL}_1, \dots, \text{RUL}_n\}$. Ten draws of $g_K(t|\text{RUL})$ are shown in Fig.~\ref{fig:E-Nfailrues-draws}. To generate each trace in the figure, I use the imputed values of the one-hundred and forty-three lifetimes that are right-censored by the end of observation and calculate the corresponding draw of $\text{RUL}^s = \{\text{RUL}^s_1, \dots, \text{RUL}^s_n\}$ using eq.~\eqref{eq:idler-rul}. $\text{RUL}^s$ is then ordered from smallest to largest and plotted as a step function against $K = \{1, \dots, 143\}$. Repeating this for every posterior draw $s = 1, \dots, S$ gives a posterior predictive distribution of $g_K(t|\text{RUL})$.

Using the resulting distribution of $g_K(t|\text{RUL})$, predictive distributions for the number of failures at any time $t$ in the future can be obtained. Figure~\ref{fig:E-Nfailrues-densities} shows the predictive densities for the number of failures within the next one (Fig.~\ref{fig:E-Nfailrues-densities}~(a)), three (Fig.~\ref{fig:E-Nfailrues-densities}~(b)), and six (Fig.~\ref{fig:E-Nfailrues-densities}~(c)) months. From the draws that make up the distributions shown in the figure, it is straightforward to obtain the posterior estimates and uncertainty intervals. Such distributions are useful for managing risk in the short term and planning, for example, managing the inventory of replacement idlers kept on site.

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/E-n-failures-draws.pdf}
  \caption{Ten draws of the cumulative failures of idler frames following the end of the observation period. The horizontal axis is the days since the end of the observation period, and the vertical axis is the cumulative number of failures.}
  \label{fig:E-Nfailrues-draws}
\end{figure}

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/E-n-failures-densities.pdf}
  \caption{The predictive distributions for the number of failures of idler frames in the one (a), three (b), and six (c) month period after the end of the observation period.}
  \label{fig:E-Nfailrues-densities}
\end{figure}

\subsection{Cost functions and preventative maintenance policy design} \label{subsec:idler-cost-function}

Not only are the posterior draws useful for making short-term decisions, but functions of the draws of the parameters can also inform long-term planning. Below, for example, I use the posterior distribution of the parameters to help choose a fixed time replacement interval for a preventative maintenance policy.

To implement a preventative replacement strategy, a reliability practitioner must choose a fixed time interval at which components are replaced. This choice aims to minimise the expected cost of maintenance and lost production, but it must also be practically possible. \citet{jardine2013} propose a structure for quantifying the cost of a particular preventative maintenance policy in terms of cost per unit time $C_p$ according to
\begin{equation}
  \label{eq:cost-func}
 C_p = \frac{C_{PM} N + C_{RM} E[K_{RM}|t,\theta]}{t},
\end{equation}
which balances the cost of planned maintenance $C_{PM}$ against the cost of unplanned (reactive) maintenance $C_{RM}$. In eq.~\eqref{eq:cost-func}, $N$ is the number of units covered by the policy (the 143 idler frames), $t$ is the proposed fixed time interval for the bulk replacement, and $E[K_{RM}|t,\theta]$ is the expected number of reactive maintenance events in the interval given the parameters of the lifetime distribution. Since the cost due to reactive maintenance depends on the lifetime distribution, we should incorporate the uncertainty in the parameters of this distribution. Table~\ref{tab:ch3-notation} provides a summary of the notation I use in this section.

\begin{table}
  \centering
  \caption{\label{tab:ch3-notation}Notation.}
  \centering
  \begin{tabularx}{\textwidth}{lY}
  \toprule
  \cellcolor{gray!10}{$y_n$} & \cellcolor{gray!10}{The age of the $n^{th}$ idlerframe.}\\
  $t$ & The time between bulk replacements.\\
  \cellcolor{gray!10}{$p$} & \cellcolor{gray!10}{The number of shutdowns between replacement.}\\
  $t_p$ & The time interval that corresponds to bulk replacing every $p$ shutdowns.\\
  \cellcolor{gray!10}{$K_{RM}$} & \cellcolor{gray!10}{The number of reactive maintenance events.}\\
  $K_{RM p}$ & The number of reactive maintenance events in $t_p$.\\
  \cellcolor{gray!10}{$\Delta K_{RM p}$} & \cellcolor{gray!10}{The number of reactive maintenance events in the interval from $t_{p - 1}$ to $t_{p}$.}\\
  $\Delta K_{F p}$ & The number of failures in the interval from $t_{p - 1}$ to $t_{p}$.\\
  \cellcolor{gray!10}{$C_p$} & \cellcolor{gray!10}{The cost per unit time of the preventative maintenacne policy given a fixed time interval of $t_p$.}\\
  $C_{RM}$ & The cost of reactive maintenance.\\
  \cellcolor{gray!10}{$C_{PM}$} & \cellcolor{gray!10}{The cost of preventative maintenance.}\\
  $N$ & The number of units covered by the preventative replacement policy.\\
  \cellcolor{gray!10}{$I_n$} & \cellcolor{gray!10}{An indicator variable indicating if an idlerframe failed in an interval.}\\
  $P_{RM}$ & The probability that a failure needs to be replaced immediately, resulting in a reactive maintenance event.\\
  \cellcolor{gray!10}{$\Delta t_{shuts}$} & \cellcolor{gray!10}{The length of the operational period between shuts: $t_p - t_{p - 1}$ weeks.}\\

  \bottomrule
  \end{tabularx}
\end{table}

Here, I discuss how, in principle, posterior uncertainty can be propagated through the cost function in eq.~\eqref{eq:cost-func} to choose a fixed time interval for the idler frames' bulk replacement. $t$ denotes the interval between bulk replacements of the idler frames analysed in Sec.~\ref{sec:idler-frame-posterior}, but the bulk replacement can only be performed during a shutdown period, which occur every six weeks. Therefore, the reliability practitioner must choose if the idlers in the frames should be replaced every $p = \{1,\dots, 44\}$ shutdowns, which corresponds to intervals of $t_p = \{6, \dots 264\}$ weeks. I do not consider replacement intervals greater that $264$ weeks ($5$ years) since this is well beyond the posterior estimate of the average lifetime of the idler frames. The cost to replace an idler in a bulk replacement during a shutdown period is about $\$250$ per idler, or about $\$750$ per frame. However, if an idler needs to be replaced during a period of operation, this costs around $\$2,000$ in parts and labour and typically takes around two hours. Critical conveyors in the circuit will transport around $15000$ tonnes/hour of iron ore. At a conservative iron ore price of $\$100$ a tonne, a two-hour stoppage equates to $\$3{,}000{,}000$ in lost production. Therefore, eq.~\eqref{eq:cost-func} can be writen for the bulk replacements of the idlers as
\begin{equation}
  \label{eq:cost-func-idlers}
 C_p = \frac{\$750 \times 143 + (\$3{,}000{,}000 + \$2{,}000) E[K_{RM p}|t_p,\beta,\eta]}{t_p}.
\end{equation}
Here, because the expected number of reactive maintenance events in the interval, $E[K_{RM p}|t_p,\beta,\eta]$ (where $K_{RM p}$ is the number of reactive maintenance events in an interval of $t_p$), depends on the posterior distribution of the parameters $\beta$ and $\eta$, $E[K_{RM p}|t_p,\beta,\eta]$ is a random variable, and as a result, so too is the cost per unit time $C_p$. Samples from the distribution of $C_p$ are obtained by calculating $E[K_{RM p}|t_p,\beta^s,\eta^s]$: conditioning on each draw from the posterior. However, it is slightly more complicated to calculate this value for the idler frames than in the examples provided in \citet{jardine2013}.

\paragraph*{Expected number of reactive maintenance events}

Calculating the expected number of reactive maintenance events in an interval is non-trivial for two reasons: first, the idlers are repeatedly replaced when they fail, and second, not all idler frame failures will cause a reactive maintenance event, only those that fail in a way that poses an immediate threat to the belt. Because of these two reasons, there is no closed form expression for $E[K_{RM p}|t_p,\beta,\eta]$ and, therefore, it needs to be approximated numerically. Section~2.4.3 of \citet{jardine2013} discusses some methods to determine the expected number of repeat failures in a time interval for more straightforward cases, and here I describe a method for the idler frames when not all failures result in reactive maintenance and inflated costs.

To generate draws of $E[K_{RM p}|t_p,\beta,\eta]$, I approximate $E[K_{RM p}|t_p,\beta^s,\eta^s]$ for draws $\beta^s$ and $\eta^s$ from the posterior. I thin the draws, using only every fifth draw from the posterior because the procedure is computationally intensive: $s = \{1,5, 10, \dots, S\}$. The process is described in Alg.~\ref{algo:K_RM}. To approximate $E[K_{RM p}|t_p,\beta^s,\eta^s]$, I simulate $K_{RM p}$ from $p = 1$ to $44$ shutdowns using $\beta^s$ and $\eta^s$ one-thousand times and then calculate the average value of each $K_{RM p} = \{K_{RM 1}, \dots, K_{RM 44}\}$ over the simulations. 

Each simulation run to produce $K_{RM p}$ reflects the typical workflow on the mine: frames fail in the period between shutdowns and, unless they are an immediate threat to the belt, are flagged and maintained in the next shutdown. However, if an idler in the frame fails in a way that immediately threatens to damage the belt, the conveyor is stopped and the idlers in that frame replaced, which is when the high reactive maintenance cost is incurred. To generate $K_{RM p}$ in each run of the numerical procedure, starting from $p = t_p = K_{RM p} = 0$, I simulate the number of the reactive maintenance events in the operational period between shutdowns $\Delta K_{RM p} = K_{RM p} - K_{RM p-1}$ (i.e.\ $K_{RM p} = \sum_{p}^{j} \Delta K_{RM j}$). 

$\Delta K_{RM p}$ for each operational interval depends on the number of idler frame failures in the interval $\Delta K_{F p}$. The number of failures in the interval between shutdowns is the sum of $N$ (the number of frames) independent Bernoulli trials
\begin{align*}
 I_n|\Delta t_p, y_n, \beta^s, \eta^s \sim & \mbox{Bernoulli}(P_{F n}) \\
 \Delta K_{F p} = & \sum^N_{n = 1} I_n
\end{align*}
where $I_n$ is an indicator variable that indicates if frame $n$ has failed and $P_{\text{UF} n}$ is the probability that the frame will fail in the operating period $\Delta t_p = t_p - t_{p-1}$ given its ages $y_n$ at the start of the period, which is calculated using the Weibull CDF $F_{\text{W}}(.)$ according to
\begin{equation}
  \label{eq:P-UF}
 P_{F n} = \frac{F_{\text{W}}(y_n + \Delta t_p|\beta^s, \eta^s) - F_{\text{W}}(y_n|\beta^s, \eta^s)}{1 - F_{\text{W}}(y_n|\beta^s, \eta^s)}.
\end{equation}
Equation~\eqref{eq:P-UF} is the probability that the age $y_n$ of an idler frame when it fails will fall in the interval $t_p$--$t_{p-1}$ given that it has survived up to $t_{p-1}$. Each of the $\Delta K_{F p}$ idler frame failures in the operating period has a chance of triggering a reactive maintenance event. I assign the probability $P_{RM} = 0.05$ that a frame failure must be replaced immediately during the operational periods, resulting in a reactive maintenance event. The number of reactive maintenance events in a period between two shutdowns, $\Delta K_{RM p}$, has a binomial distribution with $\Delta K_{F p}$ trials and probability $P_{RM}$:
\begin{equation*}
 \Delta K_{RM p}|\Delta K_{F p} \sim \mbox{Binom}(K_{F p}, P_{RM}).
\end{equation*}
After simulating the number of events in each period between shutdowns, I reset the age of any failed frames to zero and progress the surviving frames' ages by $\Delta t_p$, and then move to the next step and repeat the same process.

\begin{algorithm}
	\caption{Numerical procedure to calculate the expected cumulative number of reactive maintenance events. For every fifth draw from the posterior, $1000$ simulations are run, each $44$ shutdowns long.}
  \label{algo:K_RM}
	\begin{algorithmic}[1]
    \State Assign simulation parameters
    \State $N_{\text{frames}} \gets 143$         \Comment{\small{Number of frames}}
    \State $N_{\text{shuts}} \gets 44$           \Comment{\small{Number of shutdowns to run each simulation for}}
    \State $N_{\text{runs}} \gets 1000$          \Comment{\small{Number of runs of the simulation}}
    \State $\Delta t_{shuts} \gets (6 \times 7)$ \Comment{\small{Operating days between shutdowns}}
    \State $P_{\text{RM}} \gets 0.05$            \Comment{\small{The probability of a reactive replacement event}}
    \State
		\For {every fifth posterior draw $s = 1:5:S$}
      \For {$i = 1$ to $N_{\text{runs}}$}
        \State $y_1, \dots, t_N \gets 0$         \Comment{\small{Set age of frames to zero}}
        \For {$p = 1$ to $N_{\text{shuts}}$}
          \State Calculate probability of frame failures in period between shutdowns.
          \State $P_{\text{F} n} \gets \frac{F_{\text{W}}(y_n + \Delta t_{shuts} | \theta^s) - F_{\text{W}}(y_n | \theta^s)}{1 - F_{\text{W}}(y_n | \theta^s)}$
          \State $I_n \sim \mbox{Bernoulli}(P_{\text{F} n})$   \Comment{\small{Simulate frame failures}}
          \State $\Delta K_{\text{F} p} \gets \sum^N_{n = 1} I_n$       \Comment{\small{Number of frame failures}}
          \State $\Delta K_{\text{RM} p}\sim \mbox{Binom}(\Delta K_{\text{F} p}, P_{\text{RM}})$ \Comment{\small{Number of reactive maintenance events}}
          \For {$n = 1$ to $N$}
            \If {$I_n = 1$}
              \State $y_n \gets 0$   \Comment{\small{Reset age of failed frames to 0}}
            \Else
              \State $y_n \gets y_n + \Delta t_{shuts}$   \Comment{\small{Progress age of unfailed frames}}
            \EndIf
          \EndFor
          \State Calculate cumulative number of reactive maintenance events.
          \State $K_{\text{RM} p} \gets K_{\text{RM} p-1} + \Delta K_{\text{RM} p}$
        \EndFor
        \State Save $K_{\text{RM}} = \{K_{\text{RM}_1}, \dots, K_{\text{RM}_{N_{\text{shuts}}}}\}$.
      \EndFor
    \State Average across the simulation runs to calculate expectations.
    \State $E[K_{\text{RM}_p}]$
    \EndFor
	\end{algorithmic} 
\end{algorithm} 

In each run, at the end of the forty-four shutdowns, I calculate the cumulative number of reactive maintenance events $K_{RM p} = \sum_{p}^{j} \Delta K_{RM j}$, and at the end of the one-thousand repeat simulations for each draw from the posterior, I calculate the average of each of the forty-four $K_{RM p}$ across the simulations. The result is an approximation of the expected number of reactive maintenance events in each choice of fixed time replacement interval, conditioned on the draw from the posterior, $\{E[K_{RM p}|t_p,\beta^s,\eta^s]\}^{44}_{p = 1}$. These draws of $E[K_{RM p}|t_p,\beta^s,\eta^s]$ can then be used in the cost function in eq.~\eqref{eq:cost-func-idlers} to obtain samples from the predictive distribution of $C_p$ conditioning on the posterior of the parameters and the interval $t_p$.

\paragraph*{Choosing a fixed time replacement interval}

Figure~\ref{fig:preventative-repl-decision} shows the predictive distribution of $C_p$ for the different choices of fixed time replacement intervals going up to five years along with the median and $50\%$ and $90\%$ intervals of the distributions. Importantly, the distributions provide the range from the `best case scenario' to the `worst case scenario' of the average cost for a chosen fixed time replacement interval based on the posterior uncertainty. In the figure, when the fixed time interval is greater than $150$ weeks, bulk replacements stop impacting $C_p$, which makes sense considering that the posterior expectation of an idler frame lifetime is around $3.5$ years ($185$ weeks). The biggest potential cost savings are for the fixed time replacement intervals shorter than $60$ weeks.

\begin{figure}[tbp]
  \centering
  \includegraphics[width=0.95\textwidth]{./figures/ch-3/cost-funciton.pdf}
  \caption{The cost per unit time of preventative maintenance policies for idlers. On the horizontal axis is the cost per unit time, and on the vertical is the fixed time replacement interval. The point and intervals show the median and $0.5$ and $0.9$ intervals. The grey densities show the full distributions.}
  \label{fig:preventative-repl-decision}
\end{figure}

Table~\ref{tab:cost-per-unit-time} summarises the predictive distributions for the ten shortest fixed time intervals. 
The fixed time interval with the smallest potential cost per day is $t_p = 12$ weeks (every two shutdowns) since the lower $90\%$ uncertainty bound is only $\$9{,}818$ per day; in other words 
\begin{equation*}
 \text{Pr}\left[C_p < \$9{,}818 | t_p = 12 \: \text{weeks} \right] = 0.05.
\end{equation*}
However, the uncertainty around the lifetime distribution also means that replacing the idlers in the frames every twelve weeks could be over-maintaining the idler frames since the upper bound of the $90\%$ uncertainty interval at $t_p = 12$ weeks is the second largest, after $t_p = 6$ weeks.

\input{./tables/ch-3/cost-function-summary.tex}

The safer choices are the fixed time interval with the lowest risk of over-maintaining the idler frames. For example the upper bound of the $90\%$ intervals for $t_p = 30$, $36$, and $42$ weeks are $\$16{,}480$, $\$16{,}480$, and $\$16{,}498$ per day, respectively. These choices offer reduced costs, although possibly not the largest reduction, and the reasonably large replacement intervals are desirable because they provide flexibility when planning the replacement work around the maintenance of other assets, i.e., they would take up less of the collective labour resources.

Another way that the fixed time interval could be chosen is based on some criterion, e.g.\ the highest probability that the cost will be less than $\$15{,}000$ a day; in other words, the minimum $\text{Pr}\left[C_p < \$15{,}000 | t_p \right]$. The rightmost column in Table~\ref{tab:cost-per-unit-time} shows this probability for each fixed time interval. Based on this criterion and the posterior uncertainty around the lifetime distribution, the most suitable fixed time interval is either 18 or 24 weeks. However, 12-48 weeks all have very similar probabilites, and so are all reasonable choices. The final decision depends on the wider context of maintenance planning at the mine. Note that these conclusions would differ for different conveyors since their reliability, the cost of maintaining them, and their impact on production will differ. 

Lastly, the cost function in eq.~\eqref{eq:cost-func} contains only the expected number of reactive maintenance events, not the variability. It may also be important to investigate the variability in the cost over a short period. For example, the cost of preventative maintenance over a short period should always be roughly the same, whereas the cost due to reactive maintenance may vary a lot. Therefore, it may be preferable to favour shorter fixed-time replacement intervals if it reduces the risk of large financial costs incurred over a short period of time.

\section{Discussion and conclusions} \label{sec:idler-frame-conclusions}

In this chapter, I have demonstrated a proposed method for modelling lifetime data that are right-censored and left-truncated with unknown exposure time from Chap.~\ref{chap:chapter2} on an industry dataset of idler frame failure times. From the output of the Bayesian model that imputes the partially observed lifetimes, I showed how it is easy to obtain predictive distributions (and therefore point estimates and uncertainty intervals) for the remaining useful life of the units still in operation at the end of the observation period as well as the cumulative number of failures following the end of the observation period. I also showed how to use the posterior draws of the Weibull parameters in a cost function to choose a fixed time replacement interval for a preventative maintenance policy in a way that accounts for the posterior uncertainty in the analysis.

\paragraph*{Prior-likelihood conflict}
According to the analysis in Sec.~\ref{sec:idler-frame-posterior}, the expected lifetime of an idler frame is $3.6$ years (with 90\% lower and upper bounds of 3.2 and 3.9 years). This estimate is shorter than the prior belief about the expected 5 year lifetime of an idler provided by the manufacturer, indicating conflict between the prior and the data. Possible reasons for this conflict are 1) because the analysis I perform is at the frame level since failures are not reliably reported at the idler-level, and 2) the analysis is performed with respect to calendar date. A better exposure would be throughput or travel of the belt since these more strongly indicate usage; however, only calendar time was available.

\paragraph*{Predictive distribution for RUL and cumulative failures}
I demonstrated, using the posterior draws, that imputing the partially observed lifetimes---in particular the right-censored lifetimes---in a Bayesian approach provides a convenient and straightforward way of obtaining estimates and uncertainty intervals for the RUL of the frames still in operation and the predicted cumulative number of failures. The Bayesian approach, therefore, relieves the analyst from the burden of choosing a suitable method for generating uncertainty intervals. The predictive distributions of the RUL of the idlers can be used to prioritise replacements, and the predictive distribution of the cumulative number of failures---derived from the distributions of RUL---can help with logistics. For example, many mines are remote, so they can only hold a particular amount of stock on site. Knowing a range of the possible number of failures in the next month would help decide how many replacement idlers should be kept on site.

\paragraph*{Incorporating covariates and early failures}
I have shown that analysis of the partially observed idler frame lifetimes is useful for short and long-term maintenance decisions. However, this could be improved further by including extra information, such as manufacturer or design type, which is available for the recent idler failures, or the location on the belt, for example, idlers in the impact zone where ore is loaded onto the belt or idlers near the head or tail of the belt, where it transitions onto the pulleys. This information could be included through covariates or used to divide the population into groups of similar but different idler frames, and these groups modelled hierarchically in the Bayesian model. Furthermore, in my analysis, I treated short lifetimes where $t < 21$ days as right-censoring events. These early failures can still result in downtime of the belt. Methods could be explored to include these `infant mortalities' in the model, e.g.\ using a mixture distribution such as in \citet{mittman2013}. However, such an extension would need to investigate the impacts on the imputation of the partially observed lifetimes and missing truncation times.

In this case study analysis of idler frame failures, I have emphasised how the posterior can inform decisions. This extension of the discussion of Bayesian analysis of lifetime data is useful for people applying these methods in practice. Rather than taking the point estimates of the quantities of interest and `plugging' them into some utility function, one of the benefits of working in the Bayesian framework is how easily uncertainty can be propagated through these types of functions. It is important to emphasise this in work that targets reliability practitioners.